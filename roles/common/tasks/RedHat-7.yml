---
- yum_repository:
    file: RHEL
    name: RHEL
    description: RHEL
    baseurl: '{{ repo_url }}'
    gpgcheck: no
  when:
    - repo_url is defined
  notify:
    - yum makecache

- yum_repository:
    file: '{{ item.file }}'
    name: '{{ item.name}}'
    description: '{{ item.description }}'
    mirrorlist: '{{ item.mirrorlist }}'
    gpgcheck: no
  with_items: '{{ centos7_repo }}'
  when:
    - ansible_distribution == 'RedHat'
    - ansible_distribution_major_version == '7'
  notify:
    - setup releasever
    - yum makecache

- yum:
    name:
      - https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
    state: present

- yum:
    name: "{{ item }}"
    state: installed
  notify:
    - update locate db
  with_items: '{{ redhat_packages }}'

#- yum:
#    name: "{{ item }}"
#  with_items:
#    - python2-pip
#    - bash-completion
#    - bash-completion-extras
#    - mlocate
#    state: installed
#  notify:
#    - update locate db
#
#- yum:
#    name:
#      - python2-pip
#      - bash-completion
#      - bash-completion-extras
#      - mlocate
#    state: installed
#  notify:
#    - update locate db

- lineinfile:
    dest: /etc/selinux/config 
    regexp: ^SELINUX=.*
    line: SELINUX=disabled
    backup: yes

